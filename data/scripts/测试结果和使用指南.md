# å¤šæ¨¡æ€RAGç³»ç»Ÿæµ‹è¯•ç»“æœå’Œä½¿ç”¨æŒ‡å—

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœä½¿ç”¨condaï¼‰
conda activate rag_system

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. å¤–éƒ¨æœåŠ¡å¯åŠ¨

#### PostgreSQLæ•°æ®åº“
```bash
# ç¡®ä¿PostgreSQLæœåŠ¡æ­£åœ¨è¿è¡Œ
# Windows: æ£€æŸ¥æœåŠ¡çŠ¶æ€
net start postgresql

# åˆ›å»ºæ•°æ®åº“ï¼ˆå¦‚æœå°šæœªåˆ›å»ºï¼‰
createdb rag_system
```

#### OllamaæœåŠ¡
```bash
# å¯åŠ¨OllamaæœåŠ¡
ollama serve

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­æ‹‰å–æ‰€éœ€æ¨¡å‹
ollama pull bge-m3
ollama pull qwen2.5-vl
ollama pull qwen3:8b
```

### 3. å¯åŠ¨APIæœåŠ¡å™¨
```bash
# å¯åŠ¨FastAPIæœåŠ¡å™¨
python -m src.api.main

# æˆ–ä½¿ç”¨uvicornç›´æ¥å¯åŠ¨
uvicorn src.api.main:app --host 0.0.0.0 --port 8000 --reload
```

### 4. è®¿é—®APIæ–‡æ¡£
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:8000/docs

## ğŸ“ APIä½¿ç”¨ç¤ºä¾‹

### å¥åº·æ£€æŸ¥
```bash
curl -X GET "http://localhost:8000/rag/health"
```

### æ–‡æœ¬æŸ¥è¯¢
```bash
curl -X POST "http://localhost:8000/rag/query" \
  -H "Content-Type: application/json" \
  -d '{
    "text_query": "å›¾ä¹¦é¦†åœ¨å“ªé‡Œï¼Ÿ",
    "top_k": 5,
    "threshold": 0.3
  }'
```

### RAGå¢å¼ºæŸ¥è¯¢
```bash
curl -X POST "http://localhost:8000/rag/query-with-rag" \
  -H "Content-Type: application/json" \
  -d '{
    "text_query": "è®¡ç®—æœºå­¦é™¢çš„æ•™å­¦æ¥¼æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ",
    "top_k": 3
  }'
```

## ğŸ—‚ï¸ æ•°æ®å¤„ç†æµç¨‹

### 1. å‡†å¤‡æ•°æ®
å°†æ–‡æœ¬æ–‡ä»¶æ”¾å…¥ï¼š`data/raw/text/`
å°†å›¾åƒæ–‡ä»¶æ”¾å…¥ï¼š`data/raw/images/`

### 2. è¿è¡Œæ•°æ®å¤„ç†ç®¡é“
```bash
python data/scripts/process_data.py
```

### 3. éªŒè¯æ•°æ®å¯¼å…¥
```bash
# æ£€æŸ¥æ•°æ®åº“ä¸­çš„æ•°æ®
python -c "
from src.database.models import Document, ImageDescription
from src.database.vector_store import PostgreSQLVectorStore
from config.settings import settings

store = PostgreSQLVectorStore(settings)
print(f'æ–‡æ¡£æ•°é‡: {store.count_documents()}')
print(f'å›¾åƒæè¿°æ•°é‡: {store.count_image_descriptions()}')
"
```

## ğŸ” æµ‹è¯•æ–‡ä»¶è¯´æ˜

ç³»ç»ŸåŒ…å«4ä¸ªç‹¬ç«‹çš„æµ‹è¯•æ–‡ä»¶ï¼š

1. **`test_config.py`** - æµ‹è¯•ç¯å¢ƒé…ç½®
2. **`test_models.py`** - æµ‹è¯•æ•°æ®åº“æ¨¡å‹
3. **`test_services.py`** - æµ‹è¯•æ ¸å¿ƒæœåŠ¡
4. **`test_api.py`** - æµ‹è¯•APIæ¥å£

è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼š
```bash
python data/scripts/test_config.py
python data/scripts/test_models.py
python data/scripts/test_services.py
python data/scripts/test_api.py
```

## âš ï¸ å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥
- æ£€æŸ¥PostgreSQLæœåŠ¡æ˜¯å¦è¿è¡Œ
- éªŒè¯`.env`æ–‡ä»¶ä¸­çš„æ•°æ®åº“é…ç½®
- æ£€æŸ¥ç”¨æˆ·å/å¯†ç æ˜¯å¦æ­£ç¡®

### 2. OllamaæœåŠ¡è¿æ¥å¤±è´¥
- ç¡®ä¿`ollama serve`æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥`OLLAMA_BASE_URL`é…ç½®
- éªŒè¯æ‰€éœ€æ¨¡å‹æ˜¯å¦å·²ä¸‹è½½

### 3. å¯¼å…¥é”™è¯¯
- ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œå‘½ä»¤
- æ£€æŸ¥Pythonè·¯å¾„æ˜¯å¦æ­£ç¡®
- éªŒè¯æ‰€æœ‰ä¾èµ–æ˜¯å¦å·²å®‰è£…

### 4. APIå¯åŠ¨å¤±è´¥
- æ£€æŸ¥ç«¯å£8000æ˜¯å¦è¢«å ç”¨
- éªŒè¯æ•°æ®åº“è¿æ¥
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ä¸­çš„é”™è¯¯ä¿¡æ¯
2. æ£€æŸ¥`.env`é…ç½®æ–‡ä»¶
3. éªŒè¯å¤–éƒ¨æœåŠ¡çŠ¶æ€
4. è¿è¡Œç›¸åº”çš„æµ‹è¯•æ–‡ä»¶å®šä½é—®é¢˜

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

1. **æ•°æ®å¯¼å…¥**ï¼šä½¿ç”¨`process_data.py`å¯¼å…¥æ ¡å›­å¯¼è§ˆæ•°æ®
2. **åŠŸèƒ½æµ‹è¯•**ï¼šé€šè¿‡APIæµ‹è¯•æ£€ç´¢åŠŸèƒ½
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ ¹æ®æµ‹è¯•ç»“æœä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½
4. **éƒ¨ç½²ä¸Šçº¿**ï¼šé…ç½®ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

---

**ç³»ç»ŸçŠ¶æ€ï¼šâœ… æµ‹è¯•é€šè¿‡ï¼Œå¯ä»¥æ­£å¸¸å¯åŠ¨å’Œä½¿ç”¨**

æœ€åæ›´æ–°æ—¶é—´ï¼š2026å¹´1æœˆ7æ—¥